import{R as V,S as j,P as _,a as q,D as U,W as $,b as K,G as X,O as Y,c as I,d as J,U as Q,e as Z,f as ee,C as A,M,g as te,h as ne,H as ae,V as b,i as re,j as B,N as z,k as oe,l as ie,m as se,n as le,o as H}from"./vendor.f37ee329.js";const ce=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))i(a);new MutationObserver(a=>{for(const t of a)if(t.type==="childList")for(const o of t.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function n(a){const t={};return a.integrity&&(t.integrity=a.integrity),a.referrerpolicy&&(t.referrerPolicy=a.referrerpolicy),a.crossorigin==="use-credentials"?t.credentials="include":a.crossorigin==="anonymous"?t.credentials="omit":t.credentials="same-origin",t}function i(a){if(a.ep)return;a.ep=!0;const t=n(a);fetch(a.href,t)}};ce();const d=128,u=512,m=u*.5;let g,D,f,h,c,T=!1;const N=new b,O=new V;let p,w,l,s,G,v,P,R;const E=new H,F=5,S=[];let W=!0;const de=new j;ue();k();function ue(){g=document.createElement("div",{class:"omnomnomonomnom"}),document.body.appendChild(g),f=new _(75,window.innerWidth/window.innerHeight,1,3e3),f.position.set(0,1e3,0),f.lookAt(0,0,0),h=new q;const r=new U(16777215,.1);r.position.set(0,1,0),h.add(r);const e=new U(4235328,.6);h.add(e),c=new $,c.setPixelRatio(window.devicePixelRatio),c.setSize(window.innerWidth,window.innerHeight),g.appendChild(c.domElement),D=new K,g.appendChild(D.dom),g.style.touchAction="none",g.addEventListener("pointermove",ye),document.addEventListener("keydown",function(t){t.keyCode===87&&(p.material.wireframe=!p.material.wireframe,p.material.needsUpdate=!0)}),window.addEventListener("resize",we);const n=new X,i={impact:11,viscosity:.94,spheresEnabled:!1},a=function(){s.material.uniforms.impact.value=i.impact,s.material.uniforms.viscosityConstant.value=i.viscosity,W=i.spheresEnabled;for(let t=0;t<F;t++)S[t]&&(S[t].visible=W)};n.add(i,"impact",1,100,1).onChange(a),n.add(i,"viscosity",.9,.999,.001).onChange(a),me(),he(),a(),new Y(f,c.domElement)}function me(){const r=new I(u,u,d-1,d-1),e=new J({uniforms:Q.merge([Z.phong.uniforms,{heightmap:{value:null}}]),vertexShader:document.getElementById("waterVertexShader").textContent,fragmentShader:ee.meshphong_frag});e.lights=!0,Fe("#DAFBFF");const n=0,i=16576;console.log(e.opacity),e.color=new A(n),e.specular=new A(i),e.shininess=2e3,console.log(e.specular),e.uniforms.diffuse.value=e.color,e.uniforms.specular.value=e.specular,e.uniforms.shininess.value=Math.max(e.shininess,1e-4),e.uniforms.opacity.value=e.opacity,e.defines.WIDTH=d.toFixed(1),e.defines.BOUNDS=u.toFixed(1),G=e.uniforms,p=new M(r,e),p.rotation.x=-Math.PI/2,p.matrixAutoUpdate=!1,p.updateMatrix(),h.add(p);const a=new I(u,u,1,1);w=new M(a,new te({color:16777215,visible:!1})),w.rotation.x=-Math.PI/2,w.matrixAutoUpdate=!1,w.updateMatrix(),h.add(w),l=new ne(d,d,c),fe()&&l.setDataType(ae);const t=l.createTexture();pe(t),s=l.addVariable("heightmap",document.getElementById("heightmapFragmentShader").textContent,t),l.setVariableDependencies(s,[s]),s.material.uniforms.mousePos={value:new b(1e4,1e4)},s.material.uniforms.impact={value:11},s.material.uniforms.viscosityConstant={value:.94},s.material.uniforms.heightCompensation={value:0},s.material.defines.BOUNDS=u.toFixed(1);const o=l.init();o!==null&&console.error(o),l.createShaderMaterial(document.getElementById("smoothFragmentShader").textContent,{smoothTexture:{value:null}}),v=l.createShaderMaterial(document.getElementById("readWaterLevelFragmentShader").textContent,{point1:{value:new b},levelTexture:{value:null}}),v.defines.WIDTH=d.toFixed(1),v.defines.BOUNDS=u.toFixed(1),R=new Uint8Array(4*1*4),P=new re(4,1,{wrapS:B,wrapT:B,minFilter:z,magFilter:z,format:oe,type:ie,depthBuffer:!1})}function fe(){return!!navigator.userAgent.match(/Safari/i)&&!navigator.userAgent.match(/Chrome/i)}function pe(r){const e=10;function n(t,o){let x=e,y=.025,L=0;for(let C=0;C<15;C++)L+=x*de.noise(t*y,o*y),x*=.53+.025*C,y*=1.25;return L}const i=r.image.data;let a=0;for(let t=0;t<d;t++)for(let o=0;o<d;o++){const x=o*128/d,y=t*128/d;i[a+0]=n(x,y),i[a+1]=i[a+0],i[a+2]=0,i[a+3]=1,a+=4}}function he(){const r=new M(new se(4,24,12),new le({color:16776960}));for(let e=0;e<F;e++){let n=r;e<F-1&&(n=r.clone()),n.position.x=(Math.random()-.5)*u*.7,n.position.z=(Math.random()-.5)*u*.7,n.userData.velocity=new H,h.add(n),S[e]=n}}function ge(){const r=l.getCurrentRenderTarget(s);v.uniforms.levelTexture.value=r.texture;for(let e=0;e<F;e++){const n=S[e];if(n){const i=.5*n.position.x/m+.5,a=1-(.5*n.position.z/m+.5);v.uniforms.point1.value.set(i,a),l.doRenderTarget(v,P),c.readRenderTargetPixels(P,0,0,4,1,R);const t=new Float32Array(R.buffer);E.set(t[1],0,-t[2]);const o=n.position;o.y=t[0],E.multiplyScalar(.1),n.userData.velocity.add(E),n.userData.velocity.multiplyScalar(.998),o.add(n.userData.velocity),o.x<-m?(o.x=-m+.001,n.userData.velocity.x*=-.3):o.x>m&&(o.x=m-.001,n.userData.velocity.x*=-.3),o.z<-m?(o.z=-m+.001,n.userData.velocity.z*=-.3):o.z>m&&(o.z=m-.001,n.userData.velocity.z*=-.3)}}}function we(){f.aspect=window.innerWidth/window.innerHeight,f.updateProjectionMatrix(),c.setSize(window.innerWidth,window.innerHeight)}function ve(r,e){N.set(r/c.domElement.clientWidth*2-1,-(e/c.domElement.clientHeight)*2+1),T=!0}function ye(r){r.isPrimary!==!1&&ve(r.clientX,r.clientY)}function k(){requestAnimationFrame(k),xe(),D.update()}function xe(){const r=s.material.uniforms;if(T){O.setFromCamera(N,f);const e=O.intersectObject(w);if(e.length>0){const n=e[0].point;r.mousePos.value.set(n.x,n.z)}else r.mousePos.value.set(1e4,1e4);T=!1}else r.mousePos.value.set(1e4,1e4);l.compute(),W&&ge(),G.heightmap.value=l.getCurrentRenderTarget(s).texture,c.render(h,f)}function Fe(r){var e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(r);return e?{r:parseInt(e[1],16),g:parseInt(e[2],16),b:parseInt(e[3],16)}:null}
